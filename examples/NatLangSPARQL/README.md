# AI-Powered SPARQL Query Generator and Executor

This repository contains two Python scripts that work together to enable natural language querying of Knowledge Assets (KAs) stored in the OriginTrail Decentralized Knowledge Graph (DKG) using AI-generated SPARQL queries.

## Components

1. `loadKAs.py`: This script takes a list of Knowledge Asset (KA) DIDs as input and generates an Ontology file in JSON-LD format. The generated ontology represents the subset of the entire ontology used by the combined data in the specified KAs.

2. `GenSPARQL.py`: This script utilizes the ontology generated by `loadKAs.py` and a natural language prompt to generate a SPARQL query using a Language Model (LLM). The generated query is then executed on the OriginTrail DKG to retrieve the relevant information, which is returned to the user.

## Pre-requisites

- Python 3.10 or higher.
- Access to an OriginTrail DKG node. You can setup your own by following instructions [here](https://docs.origintrail.io/decentralized-knowledge-graph-layer-2/testnet-node-setup-instructions/setup-instructions-dockerless)
- OpenAI API key

## Installation

1. Clone this repository:
   ```bash
   git clone https://github.com/your-username/your-repository.git
   ```

2. Install the required Python packages:
   ```bash
   pip install -r requirements.txt
   ```

## Environment Variables

You'll need to setup your environment variables. Copy the .env.example to a new .env file:

```bash
cp .env.example .env
```

Open the .env file and replace the placeholders with your actual values. The file should look like this:

```makefile
OT_NODE_HOSTNAME=<Your OT Node Hostname>
WALLET_PUBLIC_KEY=<Your Wallet Public Key>
WALLET_PRIVATE_KEY=<Your Wallet Private Key>
OPENAI_KEY=<Your OpenAI API Key>
RPC_ENDPOINT=<Your Blockchain RPC URL>
```

## Usage

### loadKAs.py

To generate the Ontology file, run the following command:

```bash
python loadKAs.py <KA_DID_1> <KA_DID_2> ... <KA_DID_N> [--ontology-url <ONTOLOGY_URL>]
```

- `<KA_DID_1>`, `<KA_DID_2>`, ..., `<KA_DID_N>`: The list of Knowledge Asset DIDs to be processed. For example: `did:dkg:otp/0x1a061136ed9f5ed69395f18961a0a535ef4b3e5f/2679613`.
- `--ontology-url <ONTOLOGY_URL>` (optional): The URL that returns a JSON-LD Ontology representing the entire ontology used by the data. If provided, the script will extract the subset of the ontology used by the specified KAs.

### GenSPARQL.py

To generate a SPARQL query and execute it on the OriginTrail DKG, run the following command:

```bash
python GenSPARQL.py "<NATURAL_LANGUAGE_PROMPT>"
```

- `"<NATURAL_LANGUAGE_PROMPT>"`: The natural language prompt describing the information you want to retrieve from the KAs.

The script will use the ontology generated by `loadKAs.py` and the provided natural language prompt to generate a SPARQL query. The query will then be executed on the OriginTrail DKG, and the results will be returned to the user.


## Contributing

Contributions are welcome! If you find any issues or have suggestions for improvements, please open an issue or submit a pull request.

## License

This project is licensed under the [MIT License](LICENSE).
